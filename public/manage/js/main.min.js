$(document).ready(function(){!function(){if(0!==$("input.fileupload").length){var e='<tr class="template-upload fade in"><td><span class="preview"><canvas width="46" height="80"></canvas></span></td><td> <p class="name">${fileName_}</p>  </td><td>    <button class="btn btn-primary start">       <span>Start</span>    </button>    <button class="btn btn-warning cancel">       <span>Cancel</span>    </button>        </td></tr>',t={};$("input.fileupload").on("click",function(){t.id=$(this).parent().parent().parent().attr("id"),console.log(t.id)}),$("input.fileupload").fileupload({autoUpload:!0,url:"/admin/product/"+t.id+"/image",dataType:"json",add:function(n,a){a.url="/admin/product/"+t.id+"/image";var i=$.tmpl(e,{fileName_:a.files[0].name,fileSize_:(a.files[0].size/1e3).toFixed(2)}).appendTo(".files:eq("+$("input.fileupload").index(this)+")");a.content=i,$(".start",i).click(function(){t.bar=i,$("<p/>").text("Uploading...").addClass("uploading").replaceAll($(this)),a.submit()}),$(".cancel",i).click(function(){$("<p/>").text("cancel...").replaceAll($(this)),a.abort(),$(i).remove()})},done:function(e,t){$(".uploading",t.content).text("上传成功")},progressall:function(e,n){var a=parseInt(100*(n.loaded/n.total),10);$(".bar",t.bar).css("width",a+"%")}})}}(),function(){var e=$("#score tbody").eq(0);0!==e.length&&(e.on("click","input.change",function(e){e.preventDefault();var t=$(this).parent().parent();t.find("input").removeAttr("disabled"),t.prev().find("input").removeAttr("disabled"),$(this).addClass("hidden").next().removeClass("hidden"),t.find("input.del").addClass("hidden").next().removeClass("hidden")}),e.on("click","input.del",function(e){e.preventDefault();var t=$(this).parent().parent(),n=t.attr("id");return n?($.ajax({url:"/admin/product/"+n,type:"DELETE"}).done(function(){$("#"+n).remove()}),void 0):t.prev().remove().end().remove()}),e.on("click","input.save",function(e){e.preventDefault();var t=$(this).parent().parent(),n=$("input.save").index(this);t.find("input").attr("disabled","disabled"),t.prev().find("input").attr("disabled","disabled"),$(this).addClass("hidden").prev().removeClass("hidden").removeAttr("disabled"),t.find("input.chanle").addClass("hidden").prev().removeClass("hidden").removeAttr("disabled");var a={id:t.attr("id"),price:$('input[name="price"').eq(n).val(),reservation_day:$('input[name="reservation_day"').eq(n).val(),inventory_per_day:$('input[name="inventory_per_day"').eq(n).val(),ignore_inventory:$('input[type="checkbox"').eq(n).prop("checked"),title:$('input[name="title"').eq(n).val(),description:$('input[name="description"').eq(n).val(),content:$('input[name="content"').eq(n).val(),rank:$('input[name="rank"').eq(n).val()};$.ajax({url:"/admin/product",type:"POST",dataType:"json",data:a,success:function(e){console.log(e)}})}),e.on("click","input.chanle",function(e){e.preventDefault();var t=$(this).parent().parent();t.find("input").attr("disabled","disabled"),t.prev().find("input").attr("disabled","disabled"),$(this).addClass("hidden").prev().removeClass("hidden").removeAttr("disabled"),t.find("input.save").addClass("hidden").prev().removeClass("hidden").removeAttr("disabled")}),$("#new").click(function(){e.find("tr:eq(1)").attr("id")&&(e.find("tr:eq(1)").clone(!0).prependTo(e),e.find("tr:eq(1)").clone(!0).prependTo(e),e.find('tr:eq(0) input[type="text"]').val(""),e.find("tr:eq(1)").removeAttr("id"))}))}(),function(){var e=$("div.newOrder");0!==e.length&&($("div.wait").on("click","button.cOrder",function(){}),$("div.wait").on("click","button.rOrder",function(){}))}()});